<!DOCTYPE html> <!--use html5-->
<html lang="en">  <!--html docs always enclosed by html tags. language also spec'd here-->
  <head>  <!--webbsite metatdata-->
    <meta charset="UTF-8">
    <title>CO2 Monitor</title>  <!--displayed website title-->
    <link rel="stylesheet" href="../style.css"> <!--adds stylesheet namespace, using the file at the href location -->
    <link rel="icon" href="./favicon.ico" type="image/x-icon"> <!--small image near name-->
    <script src="https://bernii.github.io/gauge.js/dist/gauge.min.js"></script>
    <script type="module" src="extractReadings.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
  </head>
  <body>
    <h1>CO<sub>2</sub></h1>
    <canvas id="co2-gauge"></canvas>
    <p style="text-align: center;">
      <span class = co2-value></span> ppm
    </p>
    <br/><br/>
    <p>Last CO2 reading was 
      <span class = co2-value></span> 
      <span id = co2-units></span> 
      at 
      <span id = co2-lastupdated></span>
    </p>
    <p>Last humidity reading was 
      <span id = humidity-value></span> 
      <span id = humidity-units></span> 
      at 
      <span id = humidity-lastupdated></span>
    </p>
    <p>Last temperature reading was 
      <span id = temperature-value></span> 
      <span id = temperature-units></span> 
      at 
      <span id = temperature-lastupdated></span>
    </p>    


  
    <script type="module">
  import { readingsDataPromise } from "./extractReadings.js";

  var opts = {
    lines: 12,
    angle: 0.15,
    lineWidth: 0.44,
    pointer: {
      length: 0.9,
      strokeWidth: 0.035,
      color: '#000000'
    },
    limitMax: 'false', 
    percentColors: [[0.0, "#a9d70b" ], [0.50, "#f9c802"], [1.0, "#ff0000"]], // !!!!
    strokeColor: '#E0E0E0',
    generateGradient: true
  };
  var target = document.getElementById('co2-gauge');
  var gauge = new Gauge(target).setOptions(opts);
  gauge.maxValue = 2000;
  gauge.animationSpeed = 32;
  readingsDataPromise.then(data => gauge.set(data.co2._value));
</script>
<script type="module">
import { readingsDataPromise } from "./extractReadings.js";
readingsDataPromise
  .then(data => {
    console.log(data) //debug
    document.querySelectorAll(".co2-value").forEach(element => {
      element.innerHTML = Math.round(data.co2._value);
    });
    document.getElementById("co2-units").innerHTML = `ppm`;
    document.getElementById("co2-lastupdated").innerHTML = data.co2.lastReadingTime;
    document.getElementById("humidity-value").innerHTML = data.humidity._value;
    document.getElementById("humidity-units").innerHTML = `%`;
    document.getElementById("humidity-lastupdated").innerHTML = data.humidity.lastReadingTime;
    document.getElementById("temperature-value").innerHTML = data.temperature._value;
    document.getElementById("temperature-units").innerHTML = "\u2103";
    document.getElementById("temperature-lastupdated").innerHTML = data.temperature.lastReadingTime;
  });
</script>
      
  </body>
  </html>
  